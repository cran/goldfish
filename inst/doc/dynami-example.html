<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Marion Hoffman" />

<meta name="date" content="2022-08-11" />

<title>DyNAM-i: an example script</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">DyNAM-i: an example script</h1>
<h3 class="subtitle">Dynamic Network Actor Models for face-to-face
interaction data</h3>
<h4 class="author">Marion Hoffman</h4>
<h4 class="date">2022-08-11</h4>



<p>Example script analyzing the RFID validity study data (Elmer et al,
2019) with the DyNAM-i model of the <code>goldfish</code> package. Data
received from:</p>
<blockquote>
<p>Elmer, T., Chaitanya, K., Purwar, P., &amp; Stadtfeld, C. (2019). The
validity of RFID badges measuring face-to-face interactions. Behavior
research methods, 51(5), 2120-2138.</p>
</blockquote>
<p>Analyses inspired from:</p>
<blockquote>
<p>Hoffman, M., Block, P., Elmer, T., &amp; Stadtfeld, C. (2020). A
model for the dynamics of face-to-face interactions in social groups.
Network Science, 8(S1), S4-S25.</p>
</blockquote>
<div id="step-0-load-package-and-data" class="section level1">
<h1>Step 0: Load package and data</h1>
<p>First, we load the <code>goldfish</code> package and load the data. .
You can find out more about this dataset and its format by callings its
documentation.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(goldfish)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;RFID_Validity_Study&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#?RFID_Validity_Study</span></span></code></pre></div>
<p>The <code>participants</code> object contains the nodeset of actors
interacting together. The available attributes are their age, their
gender, their organizational unit (group), and their seniority
level:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">head</span>(participants)</span></code></pre></div>
<pre><code>##   actor  label present age gender group level
## 1     1 Actor1    TRUE  35      0     1     4
## 2     2 Actor2    TRUE  34      0     2     3
## 3     3 Actor3    TRUE  25      1     1     1
## 4     4 Actor4    TRUE  26      0     1     2
## 5     5 Actor5    TRUE  26      0     1     1
## 6     6 Actor6    TRUE  31      1     3     3</code></pre>
<p>The <code>rfid</code> object contains the list of dyadic interactions
collected via RFID badges. Each interaction is characterized by two
actors (<code>NodeA</code> and <code>NodeB</code>) and two time points
(<code>Start</code> and <code>End</code>):</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">head</span>(rfid)</span></code></pre></div>
<pre><code>##   NodeA NodeB      Start        End
## 1     3     4 1491329893 1491329930
## 2     1    11 1491329894 1491329926
## 3    10     8 1491329894 1491329904
## 4    10     4 1491329895 1491329911
## 5    10     5 1491329895 1491329924
## 6     3     5 1491329902 1491329913</code></pre>
<p>The <code>video</code> object contains the list of dyadic
interactions collected via video recordings and has the same format as
the <code>rfid</code> object. We know that these measures should be more
reliable, so we will work with those data in this script!</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">head</span>(video)</span></code></pre></div>
<pre><code>##    NodeA NodeB      Start        End
## 13     5     8 1491329893 1491329984
## 14     7     1 1491329893 1491329984
## 18     1    11 1491329893 1491329984
## 19     1     6 1491329893 1491329984
## 42     7     6 1491329893 1491330372
## 45    11     6 1491329893 1491330372</code></pre>
<p>Finally, the <code>known.before</code> matrix indicates which actors
knew each other before the event.</p>
<div id="step-1-create-groups-and-interaction-events" class="section level3">
<h3>Step 1: Create groups and interaction events</h3>
<p>Before specifying the model, we need to set the data in the right
format for DyNAM-i: We had a list of dyadic interactions, but DyNAM-i is
specifically meant for group interactions. More specifically, the model
is designed for events of actors joining or leavin interaction groups.
We can use this function to create these group events (please note we
need to use the right labels in the dataframe: <code>NodeA</code>,
<code>NodeB</code>,<code>Start</code>, and <code>End</code>):</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co">#?defineGroups_interaction</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>prepdata <span class="ot">&lt;-</span> <span class="fu">defineGroups_interaction</span>(video, participants,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                                     <span class="at">seed.randomization =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>This functions to creates 5 objects: 1. <code>groups</code>: a
goldfish nodeset containing the interaction groups (initially there are
as many groups as actors and they are all present, meaning
available)</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>groups <span class="ot">&lt;-</span> prepdata<span class="sc">$</span>groups</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">head</span>(groups)</span></code></pre></div>
<pre><code>##    label present
## 1 Group1    TRUE
## 2 Group2    TRUE
## 3 Group3    TRUE
## 4 Group4    TRUE
## 5 Group5    TRUE
## 6 Group6    TRUE</code></pre>
<ol start="2" style="list-style-type: decimal">
<li><code>dependent.events</code>: goldfish events specifying the events
that we want to model, when an actor (in the dataframe, the
<code>sender</code> column) joins or leaves (<code>increment</code> = 1
or -1) a group (<code>receiver</code>) at a particular point in time
(<code>time</code>)</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>dependent.events <span class="ot">&lt;-</span> prepdata<span class="sc">$</span>dependent.events</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">head</span>(dependent.events)</span></code></pre></div>
<pre><code>##         time  sender receiver increment
## 1 1491329893  Actor4   Group3         1
## 2 1491329893  Actor2   Group9         1
## 3 1491329893  Actor7   Group6         1
## 4 1491329893  Actor1   Group6         1
## 5 1491329893 Actor11   Group6         1
## 6 1491329893  Actor8   Group5         1</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><code>exogenous.events</code>: goldfish events specifying the events
that need to happen but are not modeled (for example, when an actor
leaves a group, a dependent event is created for this leaving but an
exogenous event is also created because the actor “joins” a new group,
its own isolated group)</li>
</ol>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>exogenous.events <span class="ot">&lt;-</span> prepdata<span class="sc">$</span>exogenous.events</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">head</span>(exogenous.events)</span></code></pre></div>
<pre><code>##         time  sender receiver increment
## 1 1491329893  Actor4   Group4        -1
## 2 1491329893  Actor2   Group2        -1
## 3 1491329893  Actor7   Group7        -1
## 4 1491329893  Actor1   Group1        -1
## 5 1491329893 Actor11  Group11        -1
## 6 1491329893  Actor8   Group8        -1</code></pre>
<ol start="4" style="list-style-type: decimal">
<li><code>interaction.updates</code>: goldfish events that are used to
update the number of past interactions between participants:</li>
</ol>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>interaction.updates <span class="ot">&lt;-</span> prepdata<span class="sc">$</span>interaction.updates</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">head</span>(interaction.updates)</span></code></pre></div>
<pre><code>##         time  sender receiver increment
## 1 1491329893  Actor4   Actor3         1
## 2 1491329893  Actor2   Actor9         1
## 3 1491329893  Actor7   Actor6         1
## 4 1491329893  Actor1   Actor6         1
## 5 1491329893  Actor1   Actor7         1
## 6 1491329893 Actor11   Actor1         1</code></pre>
<ol start="5" style="list-style-type: decimal">
<li><code>opportunities</code>: list containing the interaction groups
available at each decision time (this will vary when groups are being
joined or left)</li>
</ol>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>opportunities <span class="ot">&lt;-</span> prepdata<span class="sc">$</span>opportunities</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">head</span>(opportunities)</span></code></pre></div>
<pre><code>## [[1]]
##  [1]  1  2  3  4  5  6  7  8  9 10 11
## 
## [[2]]
##  [1]  1  2  3  5  6  7  8  9 10 11
## 
## [[3]]
## [1]  1  9  3  5  6  7  8 10 11
## 
## [[4]]
## [1]  1  9  3  5  6  8 10 11
## 
## [[5]]
## [1]  6  9  3  5  8 10 11
## 
## [[6]]
## [1]  6  9  3  5  8 10</code></pre>
</div>
<div id="step-2-set-up-goldfish-objects" class="section level3">
<h3>Step 2: Set up goldfish objects</h3>
<p>Now that we have all the data we need, we need to define the link
between our objects in a way that goldfish understands what is going
on.</p>
<p>First, we define the first mode nodeset, the actors:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># goldfish requires character names</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>participants<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">as.character</span>(participants<span class="sc">$</span>label)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>actors <span class="ot">&lt;-</span> <span class="fu">defineNodes</span>(participants)</span></code></pre></div>
<p>Then we define the second mode nodeset, the groups:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">defineNodes</span>(groups)</span></code></pre></div>
<p>Then we create the dynamic interaction network between the actors and
the groups, updated by the previously created events in
<code>dependent.events</code> and <code>exogenous.events</code></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>init.network <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="fu">nrow</span>(actors), <span class="fu">nrow</span>(groups))</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="co"># goldfish check that row/column names agree with the nodes data frame labels</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="fu">dimnames</span>(init.network) <span class="ot">&lt;-</span> <span class="fu">list</span>(actors<span class="sc">$</span>label, groups<span class="sc">$</span>label)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>network.interactions <span class="ot">&lt;-</span> <span class="fu">defineNetwork</span>(</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  <span class="at">matrix =</span> init.network, <span class="at">nodes =</span> actors, <span class="at">nodes2 =</span> groups, <span class="at">directed =</span> <span class="cn">TRUE</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>)</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>network.interactions <span class="ot">&lt;-</span> <span class="fu">linkEvents</span>(</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>  <span class="at">x =</span> network.interactions, <span class="at">changeEvent =</span> dependent.events,</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>  <span class="at">nodes =</span> actors, <span class="at">nodes2 =</span> groups</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>)</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>network.interactions <span class="ot">&lt;-</span> <span class="fu">linkEvents</span>(</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>  <span class="at">x =</span> network.interactions, <span class="at">changeEvent =</span> exogenous.events,</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>  <span class="at">nodes =</span> actors, <span class="at">nodes2 =</span> groups</span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>)</span></code></pre></div>
<p>Then we create the dynamic network between the actors that records
past interactions, updated by the previously created events in
<code>interaction.updates</code></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>network.past <span class="ot">&lt;-</span> <span class="fu">defineNetwork</span>(<span class="at">nodes =</span> actors, <span class="at">directed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>network.past <span class="ot">&lt;-</span> <span class="fu">linkEvents</span>(</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>  <span class="at">x =</span> network.past, <span class="at">changeEvents =</span> interaction.updates, <span class="at">nodes =</span> actors</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>) <span class="co"># don&#39;t worry about the warnings</span></span></code></pre></div>
<p>Finally, we define the events that we want to model:
<code>dependent.events</code>:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>dependent.events <span class="ot">&lt;-</span> <span class="fu">defineDependentEvents</span>(</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  <span class="at">events =</span> dependent.events, <span class="at">nodes =</span> actors,</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  <span class="at">nodes2 =</span> groups, <span class="at">defaultNetwork =</span> network.interactions</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="step-4-estimate-a-model-with-attribute-effects" class="section level3">
<h3>Step 4: Estimate a model with attribute effects</h3>
<p>Let us define some models we could estimate (we try not to put too
many effects because we have little data).</p>
<p>We first have a model only with effects related to individual
attributes (M1).</p>
<p>For the rate, we have the following effects:</p>
<ol style="list-style-type: decimal">
<li>general intercept (joining and leaving events) + dummy interaction
for the intercept of joining events specifically</li>
<li>ego age (joining): tendency for older individuals to join groups
faster</li>
<li>ego age (leaving): tendency for older individuals to leave groups
faster</li>
<li>diff age (leaving): tendency for individuals to leave groups faster
if the average sum of age difference to the group are high</li>
<li>diff level (leaving): tendency for individuals to leave groups
faster if the average sum of level difference to the group are high</li>
<li>same gender (leaving): tendency for individuals to leave groups
faster if the proportion of same gender in the group is high</li>
<li>same group (leaving): tendency for individuals to leave groups
faster if the proportion of same group in the group is high</li>
<li>tie known before (leaving): tendency for individuals to leave groups
faster if the proportion of previous friends in the group is high</li>
</ol>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>formula.rate.M1 <span class="ot">&lt;-</span> dependent.events <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>  <span class="fu">intercept</span>(network.interactions, <span class="at">joining =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>  <span class="fu">ego</span>(actors<span class="sc">$</span>age, <span class="at">joining =</span> <span class="dv">1</span>, <span class="at">subType =</span> <span class="st">&quot;centered&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>  <span class="fu">ego</span>(actors<span class="sc">$</span>age, <span class="at">joining =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">subType =</span> <span class="st">&quot;centered&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>  <span class="fu">diff</span>(actors<span class="sc">$</span>age, <span class="at">joining =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">subType =</span> <span class="st">&quot;averaged_sum&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>  <span class="fu">diff</span>(actors<span class="sc">$</span>level, <span class="at">joining =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">subType =</span> <span class="st">&quot;averaged_sum&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>  <span class="fu">same</span>(actors<span class="sc">$</span>gender, <span class="at">joining =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">subType =</span> <span class="st">&quot;proportion&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>  <span class="fu">same</span>(actors<span class="sc">$</span>group, <span class="at">joining =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">subType =</span> <span class="st">&quot;proportion&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>  <span class="fu">tie</span>(known.before, <span class="at">joining =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">subType =</span> <span class="st">&quot;proportion&quot;</span>)</span></code></pre></div>
<p>and for the choice model:</p>
<ol start="9" style="list-style-type: decimal">
<li>diff age: tendency for individuals to join groups if the average sum
of age difference to the group are high</li>
<li>diff level: tendency for individuals to join groups if the average
sum of level difference to the group are high</li>
<li>same gender: tendency for individuals to join groups if the
proportion of same gender in the group is high</li>
<li>same group: tendency for individuals to join groups if the
proportion of same group in the group is high</li>
<li>tie known before: tendency for individuals to join groups if the
proportion of previous friends in the group is high</li>
</ol>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>formula.choice.M1 <span class="ot">&lt;-</span> dependent.events <span class="sc">~</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>  <span class="fu">diff</span>(actors<span class="sc">$</span>age, <span class="at">subType =</span> <span class="st">&quot;averaged_sum&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>  <span class="fu">diff</span>(actors<span class="sc">$</span>level, <span class="at">subType =</span> <span class="st">&quot;averaged_sum&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>  <span class="fu">same</span>(actors<span class="sc">$</span>gender, <span class="at">subType =</span> <span class="st">&quot;proportion&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>  <span class="fu">same</span>(actors<span class="sc">$</span>group, <span class="at">subType =</span> <span class="st">&quot;proportion&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>  <span class="fu">tie</span>(known.before, <span class="at">subType =</span> <span class="st">&quot;proportion&quot;</span>)</span></code></pre></div>
<p>Note that effects in the choice model can mirror the ones in the
leaving model: The first model explains who people want to join (or not
join), the second explains who people want to leave (or stay with).</p>
<p>Now let us run goldfish estimation!</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>est.rate.M1 <span class="ot">&lt;-</span> <span class="fu">estimate</span>(formula.rate.M1, <span class="at">model =</span> <span class="st">&quot;DyNAMi&quot;</span>, <span class="at">subModel =</span> <span class="st">&quot;rate&quot;</span>)</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="fu">summary</span>(est.rate.M1)</span></code></pre></div>
<pre><code>## 
## Call:
## estimate(x = dependent.events ~ 1 + intercept(network.interactions, 
##     joining = 1) + ego(actors$age, joining = 1, subType = &quot;centered&quot;) + 
##     ego(actors$age, joining = -1, subType = &quot;centered&quot;) + diff(actors$age, 
##     joining = -1, subType = &quot;averaged_sum&quot;) + diff(actors$level, 
##     joining = -1, subType = &quot;averaged_sum&quot;) + same(actors$gender, 
##     joining = -1, subType = &quot;proportion&quot;) + same(actors$group, 
##     joining = -1, subType = &quot;proportion&quot;) + tie(known.before, 
##     joining = -1, subType = &quot;proportion&quot;), model = &quot;DyNAMi&quot;, 
##     subModel = &quot;rate&quot;)
## 
## 
## Effects details:
##           Object                 joining subType         
## Intercept &quot;&quot;                     &quot;&quot;      &quot;&quot;              
## intercept &quot;network.interactions&quot; &quot;1&quot;     &quot;&quot;              
## ego       &quot;actors$age&quot;           &quot;1&quot;     &quot;&quot;centered&quot;&quot;    
## ego       &quot;actors$age&quot;           &quot;-1&quot;    &quot;&quot;centered&quot;&quot;    
## diff      &quot;actors$age&quot;           &quot;-1&quot;    &quot;&quot;averaged_sum&quot;&quot;
## diff      &quot;actors$level&quot;         &quot;-1&quot;    &quot;&quot;averaged_sum&quot;&quot;
## same      &quot;actors$gender&quot;        &quot;-1&quot;    &quot;&quot;proportion&quot;&quot;  
## same      &quot;actors$group&quot;         &quot;-1&quot;    &quot;&quot;proportion&quot;&quot;  
## tie       &quot;known.before&quot;         &quot;-1&quot;    &quot;&quot;proportion&quot;&quot;  
## 
## Coefficients:
##            Estimate Std. Error  z-value  Pr(&gt;|z|)    
## Intercept -5.942916   0.322237 -18.4427 &lt; 2.2e-16 ***
## intercept  2.509660   0.334344   7.5062 6.084e-14 ***
## ego        0.061687   0.024706   2.4968   0.01253 *  
## ego        0.027958   0.035570   0.7860   0.43188    
## diff      -0.163643   0.069175  -2.3656   0.01800 *  
## diff       0.361468   0.226675   1.5947   0.11079    
## same       0.027282   0.254374   0.1073   0.91459    
## same       0.508497   0.371577   1.3685   0.17116    
## tie       -0.156303   0.346267  -0.4514   0.65170    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##   Converged with max abs. score of 0.00012 
##   Log-Likelihood: -1306.3
##   AIC:  2630.6 
##   AICc: 2631.4 
##   BIC:  2661.7 
##   model: &quot;DyNAMi&quot; subModel: &quot;rate&quot;</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>est.choice.M1 <span class="ot">&lt;-</span> <span class="fu">estimate</span>(</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>  formula.choice.M1,</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>  <span class="at">model =</span> <span class="st">&quot;DyNAMi&quot;</span>, <span class="at">subModel =</span> <span class="st">&quot;choice&quot;</span>,</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>  <span class="at">estimationInit =</span> <span class="fu">list</span>(<span class="at">opportunitiesList =</span> opportunities)</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>)</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a><span class="fu">summary</span>(est.choice.M1)</span></code></pre></div>
<pre><code>## 
## Call:
## estimate(x = dependent.events ~ diff(actors$age, subType = &quot;averaged_sum&quot;) + 
##     diff(actors$level, subType = &quot;averaged_sum&quot;) + same(actors$gender, 
##     subType = &quot;proportion&quot;) + same(actors$group, subType = &quot;proportion&quot;) + 
##     tie(known.before, subType = &quot;proportion&quot;), model = &quot;DyNAMi&quot;, 
##     subModel = &quot;choice&quot;, estimationInit = list(opportunitiesList = opportunities))
## 
## 
## Effects details:
##      Object          subType         
## diff &quot;actors$age&quot;    &quot;&quot;averaged_sum&quot;&quot;
## diff &quot;actors$level&quot;  &quot;&quot;averaged_sum&quot;&quot;
## same &quot;actors$gender&quot; &quot;&quot;proportion&quot;&quot;  
## same &quot;actors$group&quot;  &quot;&quot;proportion&quot;&quot;  
## tie  &quot;known.before&quot;  &quot;&quot;proportion&quot;&quot;  
## 
## Coefficients:
##       Estimate Std. Error z-value  Pr(&gt;|z|)    
## diff -0.107578   0.067179 -1.6014 0.1092943    
## diff  0.262945   0.225568  1.1657 0.2437353    
## same  0.292121   0.298317  0.9792 0.3274665    
## same  0.024975   0.384103  0.0650 0.9481565    
## tie   1.316141   0.378545  3.4768 0.0005074 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##   Converged with max abs. score of 0.00026 
##   Log-Likelihood: -195.16
##   AIC:  400.32 
##   AICc: 400.84 
##   BIC:  414.39 
##   model: &quot;DyNAMi&quot; subModel: &quot;choice&quot;</code></pre>
</div>
<div id="step-5-estimate-a-model-with-structural-and-time-effects" class="section level3">
<h3>Step 5: Estimate a model with structural and time effects</h3>
<p>Now let’s add effects related to group sizes and past interactions.
We add to the rate model the effects of:</p>
<ol style="list-style-type: decimal">
<li>size (leaving): tendency for individuals to leave large groups
faster</li>
<li>egopop (joining): tendency for individuals who had more interactions
in the past to join groups faster</li>
<li>egopop (leaving): tendency for individuals who had more interactions
in the past to leave groups faster</li>
</ol>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>formula.rate.M2 <span class="ot">&lt;-</span> dependent.events <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>  <span class="fu">intercept</span>(network.interactions, <span class="at">joining =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>  <span class="fu">ego</span>(actors<span class="sc">$</span>age, <span class="at">joining =</span> <span class="dv">1</span>, <span class="at">subType =</span> <span class="st">&quot;centered&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  <span class="fu">ego</span>(actors<span class="sc">$</span>age, <span class="at">joining =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">subType =</span> <span class="st">&quot;centered&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>  <span class="fu">diff</span>(actors<span class="sc">$</span>age, <span class="at">joining =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">subType =</span> <span class="st">&quot;averaged_sum&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>  <span class="fu">diff</span>(actors<span class="sc">$</span>level, <span class="at">joining =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">subType =</span> <span class="st">&quot;averaged_sum&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>  <span class="fu">same</span>(actors<span class="sc">$</span>gender, <span class="at">joining =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">subType =</span> <span class="st">&quot;proportion&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>  <span class="fu">same</span>(actors<span class="sc">$</span>group, <span class="at">joining =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">subType =</span> <span class="st">&quot;proportion&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>  <span class="fu">tie</span>(known.before, <span class="at">joining =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">subType =</span> <span class="st">&quot;proportion&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>  <span class="fu">size</span>(network.interactions, <span class="at">joining =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">subType =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a>  <span class="fu">egopop</span>(network.past, <span class="at">joining =</span> <span class="dv">1</span>, <span class="at">subType =</span> <span class="st">&quot;normalized&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>  <span class="fu">egopop</span>(network.past, <span class="at">joining =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">subType =</span> <span class="st">&quot;normalized&quot;</span>)</span></code></pre></div>
<p>We add to the choice model:</p>
<ol style="list-style-type: decimal">
<li>size: tendency for individuals to join large groups</li>
<li>alterpop: tendency for individuals to join groups with individuals
who had more interactions in the past</li>
<li>inertia, window = 60s: tendency for individuals to join groups with
a high average number of previous interactions with the group members
within the last minute</li>
<li>inertia, window = 300s: same as above, for 5 minutes</li>
</ol>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>formula.choice.M2 <span class="ot">&lt;-</span> dependent.events <span class="sc">~</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>  <span class="fu">diff</span>(actors<span class="sc">$</span>age, <span class="at">subType =</span> <span class="st">&quot;averaged_sum&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>  <span class="fu">diff</span>(actors<span class="sc">$</span>level, <span class="at">subType =</span> <span class="st">&quot;averaged_sum&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>  <span class="fu">same</span>(actors<span class="sc">$</span>gender, <span class="at">subType =</span> <span class="st">&quot;proportion&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>  <span class="fu">same</span>(actors<span class="sc">$</span>group, <span class="at">subType =</span> <span class="st">&quot;proportion&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>  <span class="fu">alter</span>(actors<span class="sc">$</span>age, <span class="at">subType =</span> <span class="st">&quot;mean&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>  <span class="fu">tie</span>(known.before, <span class="at">subType =</span> <span class="st">&quot;proportion&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>  <span class="fu">size</span>(network.interactions, <span class="at">subType =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>  <span class="fu">alterpop</span>(network.past, <span class="at">subType =</span> <span class="st">&quot;mean_normalized&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>  <span class="fu">inertia</span>(network.past, <span class="at">window =</span> <span class="dv">60</span>, <span class="at">subType =</span> <span class="st">&quot;mean&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>  <span class="fu">inertia</span>(network.past, <span class="at">window =</span> <span class="dv">300</span>, <span class="at">subType =</span> <span class="st">&quot;mean&quot;</span>)</span></code></pre></div>
<p>One can note that we have normalized (using the option
<code>subType=&quot;mean&quot;</code>) the effects related to previous
interactions, because we want to avoid time heterogeneity issues (in the
beginning no interaction has happened, at the end, a lot happened).</p>
<p>All effects can have different subTypes, please look at the goldfish
documentation to learn more.</p>
<p>Now we can run again</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>est.rate.M2 <span class="ot">&lt;-</span> <span class="fu">estimate</span>(formula.rate.M2, <span class="at">model =</span> <span class="st">&quot;DyNAMi&quot;</span>, <span class="at">subModel =</span> <span class="st">&quot;rate&quot;</span>)</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="fu">summary</span>(est.rate.M2)</span></code></pre></div>
<pre><code>## 
## Call:
## estimate(x = dependent.events ~ 1 + intercept(network.interactions, 
##     joining = 1) + ego(actors$age, joining = 1, subType = &quot;centered&quot;) + 
##     ego(actors$age, joining = -1, subType = &quot;centered&quot;) + diff(actors$age, 
##     joining = -1, subType = &quot;averaged_sum&quot;) + diff(actors$level, 
##     joining = -1, subType = &quot;averaged_sum&quot;) + same(actors$gender, 
##     joining = -1, subType = &quot;proportion&quot;) + same(actors$group, 
##     joining = -1, subType = &quot;proportion&quot;) + tie(known.before, 
##     joining = -1, subType = &quot;proportion&quot;) + size(network.interactions, 
##     joining = -1, subType = &quot;identity&quot;) + egopop(network.past, 
##     joining = 1, subType = &quot;normalized&quot;) + egopop(network.past, 
##     joining = -1, subType = &quot;normalized&quot;), model = &quot;DyNAMi&quot;, 
##     subModel = &quot;rate&quot;)
## 
## 
## Effects details:
##           Object                 joining subType         
## Intercept &quot;&quot;                     &quot;&quot;      &quot;&quot;              
## intercept &quot;network.interactions&quot; &quot;1&quot;     &quot;&quot;              
## ego       &quot;actors$age&quot;           &quot;1&quot;     &quot;&quot;centered&quot;&quot;    
## ego       &quot;actors$age&quot;           &quot;-1&quot;    &quot;&quot;centered&quot;&quot;    
## diff      &quot;actors$age&quot;           &quot;-1&quot;    &quot;&quot;averaged_sum&quot;&quot;
## diff      &quot;actors$level&quot;         &quot;-1&quot;    &quot;&quot;averaged_sum&quot;&quot;
## same      &quot;actors$gender&quot;        &quot;-1&quot;    &quot;&quot;proportion&quot;&quot;  
## same      &quot;actors$group&quot;         &quot;-1&quot;    &quot;&quot;proportion&quot;&quot;  
## tie       &quot;known.before&quot;         &quot;-1&quot;    &quot;&quot;proportion&quot;&quot;  
## size      &quot;network.interactions&quot; &quot;-1&quot;    &quot;&quot;identity&quot;&quot;    
## egopop    &quot;network.past&quot;         &quot;1&quot;     &quot;&quot;normalized&quot;&quot;  
## egopop    &quot;network.past&quot;         &quot;-1&quot;    &quot;&quot;normalized&quot;&quot;  
## 
## Coefficients:
##            Estimate Std. Error  z-value  Pr(&gt;|z|)    
## Intercept -6.376865   0.396152 -16.0970 &lt; 2.2e-16 ***
## intercept  2.942756   0.406082   7.2467  4.27e-13 ***
## ego        0.067331   0.026053   2.5844  0.009755 ** 
## ego        0.012435   0.036750   0.3384  0.735094    
## diff      -0.142109   0.076203  -1.8649  0.062200 .  
## diff       0.248709   0.240336   1.0348  0.300744    
## same       0.051020   0.263799   0.1934  0.846641    
## same       0.172918   0.409717   0.4220  0.672994    
## tie        0.145864   0.379845   0.3840  0.700971    
## size       0.133780   0.073838   1.8118  0.070015 .  
## egopop     0.068527   0.105430   0.6500  0.515708    
## egopop     0.177403   0.131982   1.3441  0.178900    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##   Converged with max abs. score of 0.00053 
##   Log-Likelihood: -1303.5
##   AIC:  2631 
##   AICc: 2632.4 
##   BIC:  2672.4 
##   model: &quot;DyNAMi&quot; subModel: &quot;rate&quot;</code></pre>
<p>and:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>est.choice.M2 <span class="ot">&lt;-</span> <span class="fu">estimate</span>(</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>  formula.choice.M2,</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>  <span class="at">model =</span> <span class="st">&quot;DyNAMi&quot;</span>, <span class="at">subModel =</span> <span class="st">&quot;choice&quot;</span>,</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>  <span class="at">estimationInit =</span> <span class="fu">list</span>(<span class="at">opportunitiesList =</span> opportunities)</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>)</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a><span class="fu">summary</span>(est.choice.M2)</span></code></pre></div>
<pre><code>## 
## Call:
## estimate(x = dependent.events ~ diff(actors$age, subType = &quot;averaged_sum&quot;) + 
##     diff(actors$level, subType = &quot;averaged_sum&quot;) + same(actors$gender, 
##     subType = &quot;proportion&quot;) + same(actors$group, subType = &quot;proportion&quot;) + 
##     alter(actors$age, subType = &quot;mean&quot;) + tie(known.before, subType = &quot;proportion&quot;) + 
##     size(network.interactions, subType = &quot;identity&quot;) + alterpop(network.past, 
##     subType = &quot;mean_normalized&quot;) + inertia(network.past, window = 60, 
##     subType = &quot;mean&quot;) + inertia(network.past, window = 300, subType = &quot;mean&quot;), 
##     model = &quot;DyNAMi&quot;, subModel = &quot;choice&quot;, estimationInit = list(opportunitiesList = opportunities))
## 
## 
## Effects details:
##          Object                 window subType            
## diff     &quot;actors$age&quot;           &quot;&quot;     &quot;&quot;averaged_sum&quot;&quot;   
## diff     &quot;actors$level&quot;         &quot;&quot;     &quot;&quot;averaged_sum&quot;&quot;   
## same     &quot;actors$gender&quot;        &quot;&quot;     &quot;&quot;proportion&quot;&quot;     
## same     &quot;actors$group&quot;         &quot;&quot;     &quot;&quot;proportion&quot;&quot;     
## alter    &quot;actors$age&quot;           &quot;&quot;     &quot;&quot;mean&quot;&quot;           
## tie      &quot;known.before&quot;         &quot;&quot;     &quot;&quot;proportion&quot;&quot;     
## size     &quot;network.interactions&quot; &quot;&quot;     &quot;&quot;identity&quot;&quot;       
## alterpop &quot;network.past&quot;         &quot;&quot;     &quot;&quot;mean_normalized&quot;&quot;
## inertia  &quot;network.past&quot;         &quot;60&quot;   &quot;&quot;mean&quot;&quot;           
## inertia  &quot;network.past&quot;         &quot;300&quot;  &quot;&quot;mean&quot;&quot;           
## 
## Coefficients:
##           Estimate Std. Error z-value Pr(&gt;|z|)   
## diff     -0.133077   0.073387 -1.8134 0.069776 . 
## diff      0.095857   0.231054  0.4149 0.678238   
## same      0.141033   0.321444  0.4387 0.660843   
## same     -0.284446   0.418710 -0.6793 0.496924   
## alter     0.033538   0.017678  1.8971 0.057809 . 
## tie       1.274992   0.393714  3.2384 0.001202 **
## size      0.097754   0.093141  1.0495 0.293934   
## alterpop  0.288526   0.170532  1.6919 0.090662 . 
## inertia   0.211654   0.458129  0.4620 0.644084   
## inertia  -0.096613   0.235330 -0.4105 0.681410   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##   Converged with max abs. score of 2e-05 
##   Log-Likelihood: -189.76
##   AIC:  399.53 
##   AICc: 401.49 
##   BIC:  427.65 
##   model: &quot;DyNAMi&quot; subModel: &quot;choice&quot;</code></pre>
<p>Of course these models ask a bit much from our data, so ideally we
would a bit more reasonable with the number of effects we include, or do
some model selection.</p>
</div>
<div id="step-6-extra-steps" class="section level3">
<h3>Step 6: Extra steps</h3>
<p>We now have for each rate model a general intercept and a dummy
interaction between the intercept and the joining events. If we want to
report the actual intercept for joining, we can calculate the following
(for M2 for example):</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>cov.matrix <span class="ot">&lt;-</span> <span class="fu">vcov</span>(est.rate.M2)</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>est.interceptjoining <span class="ot">&lt;-</span> <span class="fu">coef</span>(est.rate.M2)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(est.rate.M2)[<span class="dv">2</span>]</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>se.interceptjoining <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(</span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>  cov.matrix[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">+</span> cov.matrix[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> cov.matrix[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>)</span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>t.interceptjoining <span class="ot">&lt;-</span> est.interceptjoining <span class="sc">/</span> se.interceptjoining</span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a><span class="fu">sprintf</span>(</span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>  <span class="st">&quot;Intercept for joining: %.3f (SE = %.3f, t = %.3f)&quot;</span>,</span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a>  est.interceptjoining, se.interceptjoining, t.interceptjoining</span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] &quot;Intercept for joining: -3.434 (SE = 0.089, t = -38.477)&quot;</code></pre>
<p>This script can be continued by looking at better model
specifications than the ones provided, or trying to model the
interaction data collected from RFID badges rather than video
recordings, and maybe compare both.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
